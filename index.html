<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BookShelf</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/index.css?v=5">
    <script src="js/lib/jquery.js"></script>
    <script src="js/lib/jquery.thooClock.js"></script>
</head>
<body>
<div class="tool">
    <input type="text">
    <ul>
        <li>login</li>
        <li>logout</li>
        <li>exit</li>
        <li class="tip"></li>
    </ul>
</div>
<header>
    <div class="clock"></div>
</header>
<div class="bookshelf">
    <div class="bookshelf-item">
        <div class="book lh-book sw-book cd1"><div class="content"><div class="no">A001</div><div class="s-title">光纤光栅传感应用原理</div></div></div>
        <div class="book lh-book sw-book cd2"><div class="content"><div class="no">B001</div><div class="s-title">模糊控制理论与应用</div></div></div>
        <div class="book mh-book mw-book cd3"><div class="content"><div class="no">C001</div><div class="l-title">代码大全</div></div></div>
        <div class="book mh-book mw-book cl1"><div class="content"><div class="no">C001</div><div class="m-title">信息系统管理</div></div></div>
        <div class="book sh-book lw-book cd4"><div class="content"><div class="no">C001</div><div class="l-title">算法</div></div></div>
    </div>
    <div class="bookshelf-item"></div>
    <div class="bookshelf-item"></div>
</div>
<script>
    $(function () {
        var $tool = $('.tool');
        var $input = $(".tool input");
        var params = {};
        $('.clock').thooClock({
            size: 160,
            onAlarm:function(){
            },
            showNumerals:true,
            brandText:'THOOYORK',
            brandText2:'Germany',
            onEverySecond:function(){
                //callback that should be fired every second
            },
            //alarmTime:'15:10',
            offAlarm:function(){
            }
        });
        $(document).keydown(function(event){
//            console.log(event.keyCode);
            if(event.shiftKey && event.keyCode === 186) {
                openTool();
            }
            if(event.keyCode === 27) {
                closeTool();
            }
        });
        $input.keydown(function(event) {
            if(event.keyCode === 13) {
                var val = $(this).val();
                var prev = val.substr(0, 1);
                var cmd = '';
                var ext = '';
                if(prev === ':') {
                    cmd = val.substr(1);
                } else {
                    var index = val.indexOf('=')+1;
                    cmd = val.substr(0, index-1);
                    ext = val.substr(0, index)+ '"' + val.substr(index)+ '"';
                }
                console.log(cmd, ext);
                closeTool();
                if(cmd === '') {
                    return true;
                }
                handleCmd(cmd, ext);
            }
        });
        function handleCmd(cmd, ext) {
            if(cmd === '') {
                return false;
            }
            switch (cmd) {
                case 'login':
                    $input.val('name=');
                    openTool(true, 'input your name');
                    break;
                case '=':
                    break;
                case 'name':
                    eval("params." + ext + ";");
                    $input.val('password=');
                    openTool(true, 'input your password');
                    break;
                case 'password':
                    eval("params." + ext + ";");
                    console.log(params);
                    break;
                default:
                    break;
            }
            return true;
        }
        function closeTool() {
            $input.val('');
            $tool.hide();
        }
        function openTool(isTip, tip) {
            if(isTip === undefined) {
                isTip = false;
            }
            if(tip === undefined) {
                tip = '';
            }
            console.log(isTip, tip);
            if(isTip) {
                $tool.show().find('li.tip').text(tip).show().siblings().hide();
            }else {
                $tool.show().find('li.tip').text(tip).hide().siblings().show();
            }
            $input.focus();
        }
    });
</script>
</body>
</html>